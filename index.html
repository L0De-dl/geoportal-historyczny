<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="utf-8" />
  <title>HGIS - Gołańcz</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- LEAFLET CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

  <style>
    /* === PODSTAWY STRONY === */
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
    }

    #mapa {
      width: 100vw;
      height: 100vh;
    }

    /* === TYTUŁ MAPY === */
    .tytul-mapy {
      background: white;
      padding: 8px 12px;
      margin: 10px;
      border-radius: 8px;
      font-size: 20px;
      font-weight: bold;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
      font-family: 'Tahoma', sans-serif;
    }

    /* === PANEL WYBORU SCEN === */
    .przycisk-sceny {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 6px;
      border-radius: 6px;
      cursor: pointer;
      border: 1px solid transparent;
      user-select: none;
    }

    .przycisk-sceny img {
      width: 28px;
      height: 28px;
      object-fit: contain;
      display: block;
    }

    .przycisk-sceny.aktywna {
      background: #f0f0f0;
      border-color: #bbb;
    }

    .opis-sceny {
      font-size: 13px;
      font-family: 'Tahoma', sans-serif;
      color: #333;
      line-height: 1;
    }

    .naglowek-scen {
      font-size: 12px;
      font-weight: bold;
      text-align: center;
      margin: 4px 0;
      color: #222;
    }

    /* === STYL KONTROLKI WARSTW === */
    .leaflet-control-layers { 
      touch-action: manipulation;
    }

    .leaflet-control-layers-base label {
      font-size: 13px;
      font-family: 'Verdana', sans-serif;
      color: #444;
    }

    .naglowek-warstw {
      font-size: 12px;
      font-weight: bold;
      text-align: center;
      color: #222;
      margin-bottom: 4px;
    }
  </style>
</head>
<body>

  <!-- MAPA -->
  <div id="mapa"></div>

  <!-- LEAFLET JS -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
  // === INICJALIZACJA MAPY ===
  const mapa = L.map('mapa', { zoomControl: false, zoomSnap: 0.5 })
                .setView([52.9435, 17.3002], 17.5);

  // === GRANICE MAPY ===
  mapa.setMaxBounds([
    [52.9490239, 17.2852683], // NW
    [52.9381943, 17.3122189]  // SE
  ]);

  mapa.setMinZoom(mapa.getBoundsZoom([
    [52.9490239, 17.2852683],
    [52.9381943, 17.3122189]
  ]));

  // === KONTROLKI ===
  // Tytuł mapy
  const kontrolkaTytulu = L.control({ position: "topleft" });
  kontrolkaTytulu.onAdd = function() {
    const div = L.DomUtil.create("div", "tytul-mapy");
    div.innerHTML = "Gołańcz – interaktywny przegląd zmian przestrzennych";
    return div;
  };
  kontrolkaTytulu.addTo(mapa);

  // Zoom
  L.control.zoom({ position: "topleft" }).addTo(mapa);

  // Skala
  L.control.scale({ imperial: false, metric: true, position: 'bottomleft' }).addTo(mapa);

  // === PODKŁADY MAPOWE ===
  const podkladOSM = L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
    maxZoom: 19,
    attribution: '&copy; OpenStreetMap contributors &copy; CARTO',
    subdomains: 'abcd',
  }).addTo(mapa);

  const podklad1890 = L.imageOverlay('1890.jpg', [[52.9490319, 17.3121943], [52.9382133, 17.2852466]]);
  const podklad1911 = L.imageOverlay('1911.jpg', [[52.9490257, 17.3122210], [52.9381925, 17.2852721]]);
  const podklad1934 = L.imageOverlay('1934.jpg', [[52.9490222, 17.3122162], [52.9382042, 17.2852771]]);
  const podklad1940 = L.imageOverlay('1940.jpg', [[52.9490216, 17.3122245], [52.9381925, 17.2852719]]);
  const podklad1941 = L.imageOverlay('1941.jpg', [[52.9490186, 17.3122318], [52.9381960, 17.2852748]]);
  const podklad1966 = L.imageOverlay('1966.jpg', [[52.9490219, 17.3122117], [52.9381881, 17.2852638]]);
  const podklad1981 = L.imageOverlay('1981.jpg', [[52.9490213, 17.3122149], [52.9381963, 17.2852654]]);
  const podklad2002 = L.imageOverlay('2002.jpg', [[52.9490239, 17.3122189], [52.9381943, 17.2852683]]);
  const podklad2025 = L.tileLayer('');

  const mapaPodklady = {
    "Mapa z 1890 roku": podklad1890,
    "Mapa z 1911 roku": podklad1911,
    "Mapa z 1934 roku": podklad1934,
    "Mapa z 1940 roku": podklad1940,
    "Mapa z 1941 roku": podklad1941,
    "Mapa z 1966 roku": podklad1966,
    "Mapa z 1981 roku": podklad1981,
    "Mapa z 2002 roku": podklad2002,
    "Mapa z 2025 roku": podklad2025
  };

  const kontrolkaWarstw = L.control.layers(mapaPodklady, null, { collapsed: false }).addTo(mapa);

  // Dodanie nagłówka w panelu
  const kontenerWarstw = kontrolkaWarstw.getContainer();
  const naglowekWarstw = document.createElement("div");
  naglowekWarstw.innerHTML = "<strong>WYBÓR PODKŁADU</strong>";
  naglowekWarstw.className = "naglowek-warstw";
  kontenerWarstw.insertBefore(naglowekWarstw, kontenerWarstw.firstChild);

  // === MARKERY SCEN ===
  const ikonaZolta     = L.icon({ iconUrl: '1.png',  iconSize: [25,25] });
  const ikonaZoltaCiemna = L.icon({ iconUrl: '1c.png', iconSize: [25,25] });
  const ikonaCzerwona  = L.icon({ iconUrl: '2.png',  iconSize: [25,25] });
  const ikonaCzerwonaCiemna = L.icon({ iconUrl: '2c.png', iconSize: [25,25] });
  const ikonaNiebieska = L.icon({ iconUrl: '3.png',  iconSize: [25,25] });
  const ikonaNiebieskaCiemna = L.icon({ iconUrl: '3c.png', iconSize: [25,25] });

  const znacznik1 = L.marker([52.9441142363, 17.2998895130], { icon: ikonaZolta });
  znacznik1.on('mouseover', () => znacznik1.setIcon(ikonaZoltaCiemna));
  znacznik1.on('mouseout',  () => znacznik1.setIcon(ikonaZolta));
  znacznik1.on('click',     () => { window.location.href = "https://l0de-dl.github.io/scena1"; });

  const znacznik2 = L.marker([52.9438975, 17.2995147], { icon: ikonaCzerwona });
  znacznik2.on('mouseover', () => znacznik2.setIcon(ikonaCzerwonaCiemna));
  znacznik2.on('mouseout',  () => znacznik2.setIcon(ikonaCzerwona));
  znacznik2.on('click',     () => { window.location.href = "https://l0de-dl.github.io/scena2"; });

  const znacznik3 = L.marker([52.942454, 17.300135], { icon: ikonaNiebieska });
  znacznik3.on('mouseover', () => znacznik3.setIcon(ikonaNiebieskaCiemna));
  znacznik3.on('mouseout',  () => znacznik3.setIcon(ikonaNiebieska));
  znacznik3.on('click',     () => { window.location.href = "https://l0de-dl.github.io/scena3"; });

  const wszystkieZnaczniki = [znacznik1, znacznik2, znacznik3];

  // Usuwanie wszystkich znaczników
  function usunZnaczniki() {
    wszystkieZnaczniki.forEach(z => { if (mapa.hasLayer(z)) mapa.removeLayer(z); });
  }

  // Pokazywanie wybranej sceny
  function pokazScene(nr) {
    usunZnaczniki();
    if (nr === 1) mapa.addLayer(znacznik1);
    if (nr === 2) mapa.addLayer(znacznik2);
    if (nr === 3) mapa.addLayer(znacznik3);

    document.querySelectorAll('.przycisk-sceny').forEach((btn, idx) => {
      btn.classList.toggle('aktywna', (idx + 1) === nr);
    });
  }

  // === WYBÓR SCENY W TYM SAMYM PANELU ===
  const separator = document.createElement('hr');
  separator.style.margin = "6px 0";
  separator.style.border = "none";
  separator.style.borderTop = "1px solid #ccc";
  kontenerWarstw.appendChild(separator);

  const naglowekScen = document.createElement('div');
  naglowekScen.innerHTML = "<strong>WYBÓR SCENY</strong>";
  naglowekScen.className = "naglowek-scen";
  kontenerWarstw.appendChild(naglowekScen);

  function utworzPrzyciskSceny(nr, opis, ikonaUrl) {
    const przycisk = document.createElement('div');
    przycisk.className = 'przycisk-sceny';
    przycisk.setAttribute('role', 'button');
    przycisk.setAttribute('tabindex', '0');

    const obrazek = document.createElement('img');
    obrazek.src = ikonaUrl;
    obrazek.alt = opis;

    const t = document.createElement('div');
    t.className = 'opis-sceny';
    t.textContent = opis;

    przycisk.appendChild(obrazek);
    przycisk.appendChild(t);

    przycisk.addEventListener('click', () => pokazScene(nr));
    przycisk.addEventListener('keydown', (e) => { 
      if (e.key === 'Enter' || e.key === ' ') { 
        e.preventDefault(); 
        pokazScene(nr); 
      } 
    });

    return przycisk;
  }

  kontenerWarstw.appendChild(utworzPrzyciskSceny(1, 'Scena 1', '1.png'));
  kontenerWarstw.appendChild(utworzPrzyciskSceny(2, 'Scena 2', '2.png'));
  kontenerWarstw.appendChild(utworzPrzyciskSceny(3, 'Scena 3', '3.png'));

  // === POCZĄTEK: Scena 1 ===
  pokazScene(1);

// === Geojson ===
  const drzewa1 = {
"type": "FeatureCollection",
"name": "scena1_powierzchnia",
"crs": { "type": "name", "properties": { "name": "urn:ogc:def:crs:OGC:1.3:CRS84" } },
"features": [
{ "type": "Feature", "properties": { }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 17.3005556, 52.9443292 ], [ 17.2998073, 52.9439817 ], [ 17.2997376, 52.943889599999984 ], [ 17.2997242, 52.9438459 ], [ 17.2997268, 52.9437587 ], [ 17.2997564, 52.9437118 ], [ 17.2997897, 52.943685 ], [ 17.2998127, 52.9436665 ], [ 17.2999119, 52.9436374 ], [ 17.2999843, 52.943631 ], [ 17.300068, 52.9436403 ], [ 17.3003464, 52.9436876 ], [ 17.3007085, 52.9437587 ], [ 17.3007939, 52.9437898 ], [ 17.3008477, 52.9438188 ], [ 17.3008453, 52.9438783 ], [ 17.3007836, 52.9438961 ], [ 17.3006924, 52.9442339 ], [ 17.3007246, 52.9442646 ], [ 17.3007112, 52.9442904 ], [ 17.300679, 52.9443131 ], [ 17.3006281, 52.9443276 ], [ 17.3005905, 52.94433080000001 ], [ 17.3005556, 52.9443292 ] ] ] ] } }
]
}

L.geoJSON(drzewa1, {
  style: {
    color: "#398e3c",      // kolor linii / obrysu
    weight: 0.5,         // grubość linii
    fillColor: "#79dc7d", // kolor wypełnienia (dla poligonów)
    fillOpacity: 0.5   // przezroczystość wypełnienia
  }
}).addTo(mapa);

  const drzewa2 = {
"type": "FeatureCollection",
"name": "scena1_punkty",
"crs": { "type": "name", "properties": { "name": "urn:ogc:def:crs:OGC:1.3:CRS84" } },
"features": [
{ "type": "Feature", "properties": { "id": null }, "geometry": { "type": "MultiPoint", "coordinates": [ [ 17.299608916205294, 52.944028127732317 ], [ 17.299624504914117, 52.943877828643856 ], [ 17.299889512964157, 52.943630460257239 ], [ 17.300190894668127, 52.943674297795951 ], [ 17.300440314009339, 52.943727529033254 ], [ 17.300679340878006, 52.943780760205058 ], [ 17.300840424202541, 52.943971765635325 ], [ 17.300809246784887, 52.944147114140371 ], [ 17.300720910768206, 52.944344380359041 ], [ 17.29954656136999, 52.944189385548654 ], [ 17.299811569420033, 52.944258272199598 ], [ 17.300092166178899, 52.944345945960336 ], [ 17.300325996811285, 52.944424225953718 ] ] } }
]
}



L.geoJSON(drzewa2, {
  pointToLayer: function (feature, latlng) {
    return L.circleMarker(latlng, {
      radius: 6,         // promień kropki w pikselach
      color: "#398e3c",     // kolor obrysu
      weight: 1,         // grubość obrysu
      fillColor: "#79dc7d", // kolor wypełnienia
      fillOpacity: 0.5   // przezroczystość
    });
  }
}).addTo(mapa);

</script>
</body>
</html>









